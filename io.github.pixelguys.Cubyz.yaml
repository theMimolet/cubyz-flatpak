app-id: io.github.pixelguys.Cubyz
command: cubyz

runtime: org.freedesktop.Sdk
runtime-version: '25.08'
sdk: org.freedesktop.Sdk

separate-locales: false
finish-args:
- --share=ipc
- --share=network
- --device=dri
- --socket=x11
- --socket=pulseaudio
- --talk-name=org.gnome.SettingsDaemon
- --persist=.cubyz

modules:
- name: cubyz
  buildsystem: simple
  sources:
  - type: script
    dest-filename: apply_extra
    commands:
    - tar -xzf cubyz.tar.xz
    - rm cubyz.tar.xz
  - type: script
    dest-filename: cubyz
    commands:
    - cd /app/extra/Cubyz
    - exec ./Cubyz "$@"
  - type: extra-data
    only-arches: [ x86_64 ]
    filename: cubyz.tar.xz
    url: https://github.com/PixelGuys/Cubyz/releases/download/0.1.1/Linux-x86_64.tar.gz
    sha256: d409e15f9596322f5f5e55472acc02f820564bdedf53d7d125da9ae1cb58f11b
    size: 135095841
    x-checker-data:
      type: github-releases
      repository: PixelGuys/Cubyz
      tag-pattern: ^([0-9]+(?:\.[0-9]+)*)$
      asset-pattern: Linux-x86_64\.tar\.gz
  - type: extra-data
    only-arches: [ aarch64 ]
    filename: cubyz.tar.xz
    url: https://github.com/PixelGuys/Cubyz/releases/download/0.1.1/Linux-aarch64.tar.gz
    sha256: d316eea69402a5f9433879ab19a065a18225e84e5721635d3053bed6799bda55
    size: 135117948
    x-checker-data:
      type: github-releases
      repository: PixelGuys/Cubyz
      tag-pattern: ^([0-9]+(?:\.[0-9]+)*)$
      asset-pattern: Linux-aarch64\.tar\.gz
  - type: file
    path: io.github.pixelguys.Cubyz.desktop
  - type: file
    path: io.github.pixelguys.Cubyz.metainfo.xml
  - type: file
    path: io.github.pixelguys.Cubyz-256.png
  build-commands:
  - install -Dm755 apply_extra /app/bin/apply_extra
  - install -Dm755 cubyz /app/bin/cubyz
  - install -Dm644 ${FLATPAK_ID}.desktop /app/share/applications/${FLATPAK_ID}.desktop
  - install -Dm644 ${FLATPAK_ID}.metainfo.xml /app/share/metainfo/${FLATPAK_ID}.metainfo.xml
  - install -Dm644 ${FLATPAK_ID}-256.png /app/share/icons/hicolor/256x256/apps/${FLATPAK_ID}.png
